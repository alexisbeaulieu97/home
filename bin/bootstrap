#!/usr/bin/env bash
set -euo pipefail

ROOT_DIR="$(cd -- "$(dirname -- "${BASH_SOURCE[0]}")"/.. && pwd)"
source "$ROOT_DIR/scripts/lib/os.sh"

detect_platform

echo "Bootstrapping for: $OS_FAMILY ($OS_NAME)"

packages_common=(jq)

case "$OS_FAMILY" in
  linux)
    # Try install ACL utilities if available
    packages_linux=(acl)
    try_install_packages "${packages_common[@]}" "${packages_linux[@]}" || true
    ;;
  macos)
    try_install_packages "${packages_common[@]}" || true
    echo "Note: ACL application requires setfacl which is not available on macOS by default."
    ;;
  wsl)
    packages_linux=(acl)
    try_install_packages "${packages_common[@]}" "${packages_linux[@]}" || true
    ;;
  *)
    echo "Unsupported OS for automated bootstrap. Install jq manually."
    ;;
esac

echo "Bootstrap complete."

